# プロジェクト概要

## 概要

Discordのリアクション情報を抽出するDiscord Bot。
コマンドが入力されたらリアクションの種類とリアクションを人をまとめ、ユーザーにメッセージとして通知する。


## コマンド概要

### rinfo: リアクション情報を表示

コマンド構文

```txt
/rinfo message [exclude_user] [exclude_reaction] [include_message_user] [user_only]
```

```aiignore
📝 <メッセージへのリンク>

👍: <@111111111111111111> <@222222222222222222>
❤️: <@333333333333333333>
😂: <@111111111111111111> <@444444444444444444>
```


メッセージID指定

```txt
/rinfo message=1234567890
```

メッセージURL指定

```txt
/rinfo message=https://discord.com/channels/111111/222222/333333
```

メッセージを指定し、そのメッセージのリアクションの情報を収集してユーザーにメッセージとして投稿する。
投稿するメッセージはコードブロックで囲まれた状態。
コピペがしやすいように、かつ実際にメンションされないようにという意図がある。


- パラメータ
  - message: str（必須）
    - メッセージURL、またはメッセージID（文字列全体が数値に変換できるならメッセージIDと判断する）
  - exclude_user: str（任意）
    - 除外するユーザー
  - exclude_reaction: str（任意）
    - 除外するリアクション
  - include_message_user: bool（任意）
    - メッセージのユーザーIDも含める
  - user_only: bool（任意）
    - リアクションごとのユーザーをまとめるのではなく、ユーザーのみをまとめる

- 制約
  - 実行するユーザーがメッセージ、リアクションに対して読み込み権限を持つこと

- コンテキストメニュー
  - ◯: メッセージ

## Botインストール対象

- ◯: ユーザー
- ◯: サーバー（guild）

## セットアップ

### 前提条件
- Rust 1.88.0以上
- Discord Developer Portalでのアプリケーション作成

### インストール手順
1. リポジトリをクローン
2. `.env`ファイルの設定
3. `cargo run`で実行

### デプロイ
- 想定する実行環境（ローカル/クラウド）
- 必要なリソース（メモリ、CPU）

## 開発環境

言語: Rust
フレームワーク: Twilight

## 技術仕様

### 使用ライブラリ
- tokio: 非同期ランタイム
- twilight: Discord API クライアント
- anyhow: エラーハンドリング
- tracing: ログ出力
- dotenv: 環境変数管理

### 必要なDiscord Bot権限
- メッセージ履歴の読み取り
- メッセージの送信
- リアクションの読み取り
- スラッシュコマンドの使用

### 環境変数
- `DISCORD_TOKEN`: BotのDiscordトークン

## 制限事項

- Discord APIのレート制限に従う
- 大量のリアクションがある場合の処理時間
- メッセージの保持期間による制約
- 同時実行数の制限

## 注意点

- プライベートチャンネルでの動作制限
- 削除されたユーザーの扱い
- 大きなサーバーでのパフォーマンス考慮